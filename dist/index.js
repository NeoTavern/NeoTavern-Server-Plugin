(()=>{"use strict";var e={156:function(e,r,t){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});const o=s(t(760)),n=t(455),a=s(t(708)),i="NeoSettings.json",d="NeoSamplers",c="NeoThemes";r.default={init:async function(e){a.default.serverEvents.on("server-started",(()=>{const e=a.default.env.NEO_APP_PORT,r=a.default.env.NEO_APP_HOST;r&&e&&console.log(`[NeoTavern] Server started at http://${r}:${e}\n\n`)})),e.get("/settings",(async(e,r)=>{try{const t=o.default.join(e.user.directories.root,i),s=await(0,n.readFile)(t,"utf8"),a=JSON.parse(s);r.json(a)}catch(e){"ENOENT"===e.code?r.json({}):(console.error("Error reading settings:",e),r.status(500).json({error:"Failed to read settings"}))}})),e.post("/settings",(async(e,r)=>{try{const t=e.body,s=o.default.join(e.user.directories.root,i);await(0,n.writeFile)(s,JSON.stringify(t,null,2),"utf8"),r.json({success:!0})}catch(e){console.error("Error saving settings:",e),r.status(500).json({error:"Failed to save settings"})}})),e.get("/samplers",(async(e,r)=>{const t=o.default.join(e.user.directories.root,d);try{const e=await(0,n.readdir)(t,{withFileTypes:!0}),s=[];for(const r of e)if(r.isFile()&&r.name.endsWith(".json")){const e=r.name.slice(0,-5),a=o.default.join(t,r.name),i=await(0,n.readFile)(a,"utf8"),d=JSON.parse(i);s.push({name:e,preset:d})}r.json(s)}catch(e){"ENOENT"===e.code?r.json([]):(console.error("Error reading presets:",e),r.status(500).json({error:"Failed to read presets"}))}})),e.get("/samplers/:name",(async(e,r)=>{const{name:t}=e.params,s=o.default.join(e.user.directories.root,d),a=o.default.join(s,`${t}.json`);try{const e=await(0,n.readFile)(a,"utf8"),s=JSON.parse(e);r.json({name:t,preset:s})}catch(e){"ENOENT"===e.code?r.status(404).json({error:"Preset not found"}):(console.error("Error reading preset:",e),r.status(500).json({error:"Failed to read preset"}))}})),e.post("/samplers",(async(e,r)=>{const t=e.body;if(!t?.name)return r.status(400).json({error:"name is required in preset"});const s=o.default.join(e.user.directories.root,d);await(0,n.mkdir)(s,{recursive:!0});const a=o.default.join(s,`${t.name}.json`);try{await(0,n.writeFile)(a,JSON.stringify(t.preset,null,2),"utf8"),r.json({success:!0})}catch(e){console.error("Error saving preset:",e),r.status(500).json({error:"Failed to save preset"})}})),e.delete("/samplers/:name",(async(e,r)=>{const{name:t}=e.params,s=o.default.join(e.user.directories.root,d),a=o.default.join(s,`${t}.json`);try{await(0,n.unlink)(a),r.sendStatus(204)}catch(e){"ENOENT"===e.code?r.status(404).json({error:"Preset not found"}):(console.error("Error deleting preset:",e),r.status(500).json({error:"Failed to delete preset"}))}})),e.get("/themes",(async(e,r)=>{const t=o.default.join(e.user.directories.root,c);try{const e=await(0,n.readdir)(t,{withFileTypes:!0}),s=[];for(const r of e)if(r.isFile()&&r.name.endsWith(".json")){const e=r.name.slice(0,-5),a=o.default.join(t,r.name),i=await(0,n.readFile)(a,"utf8"),d=JSON.parse(i);s.push({name:e,preset:d})}r.json(s)}catch(e){"ENOENT"===e.code?r.json([]):(console.error("Error reading themes:",e),r.status(500).json({error:"Failed to read themes"}))}})),e.get("/themes/:name",(async(e,r)=>{const{name:t}=e.params,s=o.default.join(e.user.directories.root,c),a=o.default.join(s,`${t}.json`);try{const e=await(0,n.readFile)(a,"utf8"),s=JSON.parse(e);r.json({name:t,preset:s})}catch(e){"ENOENT"===e.code?r.status(404).json({error:"Theme not found"}):(console.error("Error reading theme:",e),r.status(500).json({error:"Failed to read theme"}))}})),e.post("/themes",(async(e,r)=>{const t=e.body;if(!t?.name||!t?.preset)return r.status(400).json({error:"Both name and preset are required"});const s=o.default.join(e.user.directories.root,c);await(0,n.mkdir)(s,{recursive:!0});const a=o.default.join(s,`${t.name}.json`);try{await(0,n.writeFile)(a,JSON.stringify(t.preset,null,2),"utf8"),r.json({success:!0})}catch(e){console.error("Error saving theme:",e),r.status(500).json({error:"Failed to save theme"})}})),e.delete("/themes/:name",(async(e,r)=>{const{name:t}=e.params,s=o.default.join(e.user.directories.root,c),a=o.default.join(s,`${t}.json`);try{await(0,n.unlink)(a),r.sendStatus(204)}catch(e){"ENOENT"===e.code?r.status(404).json({error:"Theme not found"}):(console.error("Error deleting theme:",e),r.status(500).json({error:"Failed to delete theme"}))}}))},exit:()=>{},info:{id:"neo",name:"NeoTavern Server Plugin",description:"Allows you to use NeoTavern-Frontend with SillyTavern."}}},455:e=>{e.exports=require("node:fs/promises")},708:e=>{e.exports=require("node:process")},760:e=>{e.exports=require("node:path")}},r={};var t=function t(s){var o=r[s];if(void 0!==o)return o.exports;var n=r[s]={exports:{}};return e[s].call(n.exports,n,n.exports,t),n.exports}(156),s=exports,o=t.default;for(var n in o)s[n]=o[n];o.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();